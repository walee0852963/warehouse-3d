{"ast":null,"code":"import _objectSpread from \"C:/Users/waleed/Desktop/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _objectWithoutProperties from \"C:/Users/waleed/Desktop/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";\nconst _excluded = [\"unsuspend\", \"start\", \"hls\", \"crossOrigin\", \"muted\", \"loop\", \"playsInline\", \"onVideoFrame\"],\n  _excluded2 = [\"children\", \"src\"];\nimport * as React from 'react';\nimport { useRef, useEffect, forwardRef, useImperativeHandle } from 'react';\nimport * as THREE from 'three';\nimport { useThree } from '@react-three/fiber';\nimport { suspend } from 'suspend-react';\nimport { Events } from 'hls.js';\n\n/* eslint react-hooks/exhaustive-deps: 1 */\nconst IS_BROWSER = /* @__PURE__ */((_window$document, _window$navigator) => typeof window !== 'undefined' && typeof ((_window$document = window.document) == null ? void 0 : _window$document.createElement) === 'function' && typeof ((_window$navigator = window.navigator) == null ? void 0 : _window$navigator.userAgent) === 'string')();\nlet _HLSModule = null;\nasync function getHls() {\n  var _HLSModule2;\n  (_HLSModule2 = _HLSModule) !== null && _HLSModule2 !== void 0 ? _HLSModule2 : _HLSModule = await import('hls.js'); // singleton\n  const Ctor = _HLSModule.default;\n  if (Ctor.isSupported()) {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    return new Ctor(...args);\n  }\n  return null;\n}\nfunction useVideoTexture(srcOrSrcObject) {\n  let _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n    {\n      unsuspend = 'loadedmetadata',\n      start = true,\n      hls: hlsConfig = {},\n      crossOrigin = 'anonymous',\n      muted = true,\n      loop = true,\n      playsInline = true,\n      onVideoFrame\n    } = _ref,\n    videoProps = _objectWithoutProperties(_ref, _excluded);\n  const gl = useThree(state => state.gl);\n  const hlsRef = useRef(null);\n  const texture = suspend(() => new Promise(async res => {\n    let src = undefined;\n    let srcObject = undefined;\n    if (typeof srcOrSrcObject === 'string') {\n      src = srcOrSrcObject;\n    } else {\n      srcObject = srcOrSrcObject;\n    }\n    const video = Object.assign(document.createElement('video'), _objectSpread({\n      src,\n      srcObject,\n      crossOrigin,\n      loop,\n      muted,\n      playsInline\n    }, videoProps));\n\n    // hlsjs extension\n    if (src && IS_BROWSER && src.endsWith('.m3u8')) {\n      const hls = hlsRef.current = await getHls(hlsConfig);\n      if (hls) {\n        hls.on(Events.MEDIA_ATTACHED, () => void hls.loadSource(src));\n        hls.attachMedia(video);\n      }\n    }\n    const texture = new THREE.VideoTexture(video);\n    texture.colorSpace = gl.outputColorSpace;\n    video.addEventListener(unsuspend, () => res(texture));\n  }), [srcOrSrcObject]);\n  const video = texture.source.data;\n  useVideoFrame(video, onVideoFrame);\n  useEffect(() => {\n    start && texture.image.play();\n    return () => {\n      if (hlsRef.current) {\n        hlsRef.current.destroy();\n        hlsRef.current = null;\n      }\n    };\n  }, [texture, start]);\n  return texture;\n}\n\n//\n// VideoTexture\n//\n\nconst VideoTexture = /* @__PURE__ */forwardRef((_ref2, fref) => {\n  let {\n      children,\n      src\n    } = _ref2,\n    config = _objectWithoutProperties(_ref2, _excluded2);\n  const texture = useVideoTexture(src, config);\n  useEffect(() => {\n    return () => void texture.dispose();\n  }, [texture]);\n  useImperativeHandle(fref, () => texture, [texture]); // expose texture through ref\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, children == null ? void 0 : children(texture));\n});\n\n// rVFC hook\n\nconst useVideoFrame = (video, f) => {\n  useEffect(() => {\n    if (!f) return;\n    if (!video.requestVideoFrameCallback) return;\n    let handle;\n    const callback = function () {\n      f(...arguments);\n      handle = video.requestVideoFrameCallback(callback);\n    };\n    video.requestVideoFrameCallback(callback);\n    return () => video.cancelVideoFrameCallback(handle);\n  }, [video, f]);\n};\nexport { VideoTexture, useVideoTexture };","map":{"version":3,"names":["React","useRef","useEffect","forwardRef","useImperativeHandle","THREE","useThree","suspend","Events","IS_BROWSER","_window$document","_window$navigator","window","document","createElement","navigator","userAgent","_HLSModule","getHls","_HLSModule2","Ctor","default","isSupported","_len","arguments","length","args","Array","_key","useVideoTexture","srcOrSrcObject","_ref","undefined","unsuspend","start","hls","hlsConfig","crossOrigin","muted","loop","playsInline","onVideoFrame","videoProps","_objectWithoutProperties","_excluded","gl","state","hlsRef","texture","Promise","res","src","srcObject","video","Object","assign","_objectSpread","endsWith","current","on","MEDIA_ATTACHED","loadSource","attachMedia","VideoTexture","colorSpace","outputColorSpace","addEventListener","source","data","useVideoFrame","image","play","destroy","_ref2","fref","children","config","_excluded2","dispose","Fragment","f","requestVideoFrameCallback","handle","callback","cancelVideoFrameCallback"],"sources":["C:/Users/waleed/Desktop/node_modules/@react-three/drei/core/VideoTexture.js"],"sourcesContent":["import * as React from 'react';\nimport { useRef, useEffect, forwardRef, useImperativeHandle } from 'react';\nimport * as THREE from 'three';\nimport { useThree } from '@react-three/fiber';\nimport { suspend } from 'suspend-react';\nimport { Events } from 'hls.js';\n\n/* eslint react-hooks/exhaustive-deps: 1 */\nconst IS_BROWSER = /* @__PURE__ */((_window$document, _window$navigator) => typeof window !== 'undefined' && typeof ((_window$document = window.document) == null ? void 0 : _window$document.createElement) === 'function' && typeof ((_window$navigator = window.navigator) == null ? void 0 : _window$navigator.userAgent) === 'string')();\nlet _HLSModule = null;\nasync function getHls(...args) {\n  var _HLSModule2;\n  (_HLSModule2 = _HLSModule) !== null && _HLSModule2 !== void 0 ? _HLSModule2 : _HLSModule = await import('hls.js'); // singleton\n  const Ctor = _HLSModule.default;\n  if (Ctor.isSupported()) {\n    return new Ctor(...args);\n  }\n  return null;\n}\nfunction useVideoTexture(srcOrSrcObject, {\n  unsuspend = 'loadedmetadata',\n  start = true,\n  hls: hlsConfig = {},\n  crossOrigin = 'anonymous',\n  muted = true,\n  loop = true,\n  playsInline = true,\n  onVideoFrame,\n  ...videoProps\n} = {}) {\n  const gl = useThree(state => state.gl);\n  const hlsRef = useRef(null);\n  const texture = suspend(() => new Promise(async res => {\n    let src = undefined;\n    let srcObject = undefined;\n    if (typeof srcOrSrcObject === 'string') {\n      src = srcOrSrcObject;\n    } else {\n      srcObject = srcOrSrcObject;\n    }\n    const video = Object.assign(document.createElement('video'), {\n      src,\n      srcObject,\n      crossOrigin,\n      loop,\n      muted,\n      playsInline,\n      ...videoProps\n    });\n\n    // hlsjs extension\n    if (src && IS_BROWSER && src.endsWith('.m3u8')) {\n      const hls = hlsRef.current = await getHls(hlsConfig);\n      if (hls) {\n        hls.on(Events.MEDIA_ATTACHED, () => void hls.loadSource(src));\n        hls.attachMedia(video);\n      }\n    }\n    const texture = new THREE.VideoTexture(video);\n    texture.colorSpace = gl.outputColorSpace;\n    video.addEventListener(unsuspend, () => res(texture));\n  }), [srcOrSrcObject]);\n  const video = texture.source.data;\n  useVideoFrame(video, onVideoFrame);\n  useEffect(() => {\n    start && texture.image.play();\n    return () => {\n      if (hlsRef.current) {\n        hlsRef.current.destroy();\n        hlsRef.current = null;\n      }\n    };\n  }, [texture, start]);\n  return texture;\n}\n\n//\n// VideoTexture\n//\n\nconst VideoTexture = /* @__PURE__ */forwardRef(({\n  children,\n  src,\n  ...config\n}, fref) => {\n  const texture = useVideoTexture(src, config);\n  useEffect(() => {\n    return () => void texture.dispose();\n  }, [texture]);\n  useImperativeHandle(fref, () => texture, [texture]); // expose texture through ref\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, children == null ? void 0 : children(texture));\n});\n\n// rVFC hook\n\nconst useVideoFrame = (video, f) => {\n  useEffect(() => {\n    if (!f) return;\n    if (!video.requestVideoFrameCallback) return;\n    let handle;\n    const callback = (...args) => {\n      f(...args);\n      handle = video.requestVideoFrameCallback(callback);\n    };\n    video.requestVideoFrameCallback(callback);\n    return () => video.cancelVideoFrameCallback(handle);\n  }, [video, f]);\n};\n\nexport { VideoTexture, useVideoTexture };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}