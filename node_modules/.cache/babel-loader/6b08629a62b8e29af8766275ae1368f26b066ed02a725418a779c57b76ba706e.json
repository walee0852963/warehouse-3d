{"ast":null,"code":"import _objectSpread from\"C:/Users/waleed/Desktop/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useRef,useEffect}from\"react\";import{Canvas,useFrame,useThree}from\"@react-three/fiber\";import{OrbitControls}from\"@react-three/drei\";import{Physics,RigidBody}from\"@react-three/rapier\";import*as THREE from\"three\";import\"./App.css\";// صندوق قابل للسحب\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function DraggableBox(_ref){let{position,color,setDraggingGlobal}=_ref;const rigidRef=useRef();const[dragging,setDragging]=useState(false);const[dynamic,setDynamic]=useState(false);// لتشغيل الجاذبية بعد الإفلات\nconst{camera,mouse}=useThree();useEffect(()=>{const handleMouseUp=()=>{if(dragging){setDragging(false);setDraggingGlobal(false);setDynamic(true);// بعد الإفلات، يتحول للصندوق الديناميكي\n}};window.addEventListener(\"mouseup\",handleMouseUp);return()=>window.removeEventListener(\"mouseup\",handleMouseUp);},[dragging]);useFrame(()=>{if(dragging&&rigidRef.current){const raycaster=new THREE.Raycaster();raycaster.setFromCamera(mouse,camera);const plane=new THREE.Plane(new THREE.Vector3(0,1,0),0);const pos=new THREE.Vector3();raycaster.ray.intersectPlane(plane,pos);const currentPos=rigidRef.current.translation();rigidRef.current.setNextKinematicTranslation({x:THREE.MathUtils.lerp(currentPos.x,pos.x,0.2),y:currentPos.y,z:THREE.MathUtils.lerp(currentPos.z,pos.z,0.2)});}});return/*#__PURE__*/_jsx(RigidBody,{ref:rigidRef,colliders:\"cuboid\",restitution:0.5,friction:0.5,type:dragging?\"kinematicPosition\":dynamic?\"dynamic\":\"dynamic\",children:/*#__PURE__*/_jsxs(\"mesh\",{position:position,castShadow:true,onPointerDown:e=>{if(e.button===0){e.stopPropagation();setDragging(true);setDraggingGlobal(true);setDynamic(false);// أثناء السحب، نعطل الجاذبية\n}},children:[/*#__PURE__*/_jsx(\"boxGeometry\",{args:[0.8,0.8,0.8]}),/*#__PURE__*/_jsx(\"meshStandardMaterial\",{color:dragging?\"red\":color})]})});}// المخزن الرئيسي\nfunction Warehouse(){const[inventory,setInventory]=useState({stored:5,sold:0});const[boxes,setBoxes]=useState(Array.from({length:5}).map(()=>({id:Math.random(),pos:[Math.random()*3-1.5,1,Math.random()*2-1]})));const[draggingGlobal,setDraggingGlobal]=useState(false);// إضافة صندوق جديد\nconst addItem=()=>{setInventory(prev=>_objectSpread(_objectSpread({},prev),{},{stored:prev.stored+1}));setBoxes(prev=>[...prev,{id:Math.random(),pos:[Math.random()*3-1.5,1,Math.random()*2-1]}]);};// بيع صندوق\nconst sellItem=()=>{if(inventory.stored>0){setInventory(prev=>({stored:prev.stored-1,sold:prev.sold+1}));setBoxes(prev=>prev.slice(0,-1));}};return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"warehouse\",children:/*#__PURE__*/_jsxs(Canvas,{shadows:true,camera:{position:[6,5,6],fov:50},children:[/*#__PURE__*/_jsx(\"ambientLight\",{intensity:0.6}),/*#__PURE__*/_jsx(\"directionalLight\",{position:[5,10,5],intensity:1,castShadow:true}),/*#__PURE__*/_jsxs(Physics,{gravity:[0,-9.81,0],children:[/*#__PURE__*/_jsx(RigidBody,{type:\"fixed\",children:/*#__PURE__*/_jsxs(\"mesh\",{position:[0,-0.5,0],receiveShadow:true,children:[/*#__PURE__*/_jsx(\"boxGeometry\",{args:[10,1,10]}),/*#__PURE__*/_jsx(\"meshStandardMaterial\",{color:\"#e0e0e0\"})]})}),boxes.map(box=>/*#__PURE__*/_jsx(DraggableBox,{position:box.pos,color:\"#ff9800\",setDraggingGlobal:setDraggingGlobal},box.id))]}),/*#__PURE__*/_jsx(OrbitControls,{enabled:!draggingGlobal})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"controls\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\uD83D\\uDCE6 \\u0646\\u0638\\u0627\\u0645 \\u0625\\u062F\\u0627\\u0631\\u0629 \\u0627\\u0644\\u0645\\u062E\\u0632\\u0646\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0627\\u0644\\u0645\\u062E\\u0632\\u0648\\u0646 \\u0627\\u0644\\u062D\\u0627\\u0644\\u064A: \",inventory.stored]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u0627\\u0644\\u0645\\u0628\\u0627\\u0639: \",inventory.sold]}),/*#__PURE__*/_jsx(\"button\",{onClick:addItem,children:\"\\u2795 \\u0625\\u0636\\u0627\\u0641\\u0629 \\u0628\\u0636\\u0627\\u0639\\u0629\"}),/*#__PURE__*/_jsx(\"button\",{onClick:sellItem,style:{marginLeft:\"10px\"},children:\"\\u2796 \\u0628\\u064A\\u0639 \\u0628\\u0636\\u0627\\u0639\\u0629\"})]})]});}export default Warehouse;","map":{"version":3,"names":["React","useState","useRef","useEffect","Canvas","useFrame","useThree","OrbitControls","Physics","RigidBody","THREE","jsx","_jsx","jsxs","_jsxs","DraggableBox","_ref","position","color","setDraggingGlobal","rigidRef","dragging","setDragging","dynamic","setDynamic","camera","mouse","handleMouseUp","window","addEventListener","removeEventListener","current","raycaster","Raycaster","setFromCamera","plane","Plane","Vector3","pos","ray","intersectPlane","currentPos","translation","setNextKinematicTranslation","x","MathUtils","lerp","y","z","ref","colliders","restitution","friction","type","children","castShadow","onPointerDown","e","button","stopPropagation","args","Warehouse","inventory","setInventory","stored","sold","boxes","setBoxes","Array","from","length","map","id","Math","random","draggingGlobal","addItem","prev","_objectSpread","sellItem","slice","className","shadows","fov","intensity","gravity","receiveShadow","box","enabled","onClick","style","marginLeft"],"sources":["C:/Users/waleed/Desktop/New folder/warehouse-3d/src/App.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\nimport { Canvas, useFrame, useThree } from \"@react-three/fiber\";\nimport { OrbitControls } from \"@react-three/drei\";\nimport { Physics, RigidBody } from \"@react-three/rapier\";\nimport * as THREE from \"three\";\nimport \"./App.css\";\n\n// صندوق قابل للسحب\nfunction DraggableBox({ position, color, setDraggingGlobal }) {\n  const rigidRef = useRef();\n  const [dragging, setDragging] = useState(false);\n  const [dynamic, setDynamic] = useState(false); // لتشغيل الجاذبية بعد الإفلات\n  const { camera, mouse } = useThree();\n\n  useEffect(() => {\n    const handleMouseUp = () => {\n      if (dragging) {\n        setDragging(false);\n        setDraggingGlobal(false);\n        setDynamic(true); // بعد الإفلات، يتحول للصندوق الديناميكي\n      }\n    };\n    window.addEventListener(\"mouseup\", handleMouseUp);\n    return () => window.removeEventListener(\"mouseup\", handleMouseUp);\n  }, [dragging]);\n\n  useFrame(() => {\n    if (dragging && rigidRef.current) {\n      const raycaster = new THREE.Raycaster();\n      raycaster.setFromCamera(mouse, camera);\n      const plane = new THREE.Plane(new THREE.Vector3(0, 1, 0), 0);\n      const pos = new THREE.Vector3();\n      raycaster.ray.intersectPlane(plane, pos);\n\n      const currentPos = rigidRef.current.translation();\n      rigidRef.current.setNextKinematicTranslation({\n        x: THREE.MathUtils.lerp(currentPos.x, pos.x, 0.2),\n        y: currentPos.y,\n        z: THREE.MathUtils.lerp(currentPos.z, pos.z, 0.2),\n      });\n    }\n  });\n\n  return (\n    <RigidBody\n      ref={rigidRef}\n      colliders=\"cuboid\"\n      restitution={0.5}\n      friction={0.5}\n      type={dragging ? \"kinematicPosition\" : dynamic ? \"dynamic\" : \"dynamic\"}\n    >\n      <mesh\n        position={position}\n        castShadow\n        onPointerDown={(e) => {\n          if (e.button === 0) {\n            e.stopPropagation();\n            setDragging(true);\n            setDraggingGlobal(true);\n            setDynamic(false); // أثناء السحب، نعطل الجاذبية\n          }\n        }}\n      >\n        <boxGeometry args={[0.8, 0.8, 0.8]} />\n        <meshStandardMaterial color={dragging ? \"red\" : color} />\n      </mesh>\n    </RigidBody>\n  );\n}\n\n\n// المخزن الرئيسي\nfunction Warehouse() {\n  const [inventory, setInventory] = useState({ stored: 5, sold: 0 });\n  const [boxes, setBoxes] = useState(\n    Array.from({ length: 5 }).map(() => ({\n      id: Math.random(),\n      pos: [Math.random() * 3 - 1.5, 1, Math.random() * 2 - 1],\n    }))\n  );\n  const [draggingGlobal, setDraggingGlobal] = useState(false);\n\n  // إضافة صندوق جديد\n  const addItem = () => {\n    setInventory((prev) => ({ ...prev, stored: prev.stored + 1 }));\n    setBoxes((prev) => [\n      ...prev,\n      { id: Math.random(), pos: [Math.random() * 3 - 1.5, 1, Math.random() * 2 - 1] },\n    ]);\n  };\n\n  // بيع صندوق\n  const sellItem = () => {\n    if (inventory.stored > 0) {\n      setInventory((prev) => ({ stored: prev.stored - 1, sold: prev.sold + 1 }));\n      setBoxes((prev) => prev.slice(0, -1));\n    }\n  };\n\n  return (\n    <div className=\"container\">\n      <div className=\"warehouse\">\n        <Canvas shadows camera={{ position: [6, 5, 6], fov: 50 }}>\n          <ambientLight intensity={0.6} />\n          <directionalLight position={[5, 10, 5]} intensity={1} castShadow />\n          <Physics gravity={[0, -9.81, 0]}>\n            {/* الأرضية ثابتة */}\n            <RigidBody type=\"fixed\">\n              <mesh position={[0, -0.5, 0]} receiveShadow>\n                <boxGeometry args={[10, 1, 10]} />\n                <meshStandardMaterial color=\"#e0e0e0\" />\n              </mesh>\n            </RigidBody>\n\n            {/* الصناديق */}\n            {boxes.map((box) => (\n              <DraggableBox\n                key={box.id}\n                position={box.pos}\n                color=\"#ff9800\"\n                setDraggingGlobal={setDraggingGlobal}\n              />\n            ))}\n          </Physics>\n\n          {/* التحكم بالكاميرا مع تعطيل أثناء السحب */}\n          <OrbitControls enabled={!draggingGlobal} />\n        </Canvas>\n      </div>\n\n      <div className=\"controls\">\n        <h2>📦 نظام إدارة المخزن</h2>\n        <p>المخزون الحالي: {inventory.stored}</p>\n        <p>المباع: {inventory.sold}</p>\n        <button onClick={addItem}>➕ إضافة بضاعة</button>\n        <button onClick={sellItem} style={{ marginLeft: \"10px\" }}>\n          ➖ بيع بضاعة\n        </button>\n      </div>\n    </div>\n  );\n}\n\nexport default Warehouse;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}